# Chess AI ç£ç›˜ç©ºé—´ç®¡ç†æŒ‡å—

æœ¬æŒ‡å—å¸®åŠ©æ‚¨è§£å†³åœ¨AutoDLç­‰ç¯å¢ƒä¸­è®­ç»ƒChess AIæ—¶é‡åˆ°çš„ç£ç›˜ç©ºé—´ä¸è¶³é—®é¢˜ã€‚

## ğŸš¨ é—®é¢˜ç—‡çŠ¶

å¦‚æœæ‚¨é‡åˆ°ä»¥ä¸‹é”™è¯¯ï¼Œè¯´æ˜ç£ç›˜ç©ºé—´ä¸è¶³ï¼š
```
OSError: [Errno 28] No space left on device
```

## ğŸ› ï¸ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1: è‡ªåŠ¨è®¾ç½®æ•°æ®ç›˜ (æ¨è)

1. **è¿è¡Œè®¾ç½®è„šæœ¬**
   ```bash
   python setup_data_disk.py
   ```
   
2. **è®¾ç½®ç¯å¢ƒå˜é‡**
   ```bash
   source set_data_path.sh
   ```
   
3. **å¼€å§‹è®­ç»ƒ**
   ```bash
   python train_with_data_disk.py
   ```

### æ–¹æ¡ˆ2: æ‰‹åŠ¨æŒ‡å®šæ•°æ®ç›˜

```bash
# è®¾ç½®ç¯å¢ƒå˜é‡æŒ‡å‘æ‚¨çš„æ•°æ®ç›˜
export CHESS_AI_DATA_PATH=/root/autodl-tmp

# è¿è¡Œè®­ç»ƒ
python fixed_test_training.py
```

### æ–¹æ¡ˆ3: ä¸€è¡Œå‘½ä»¤

```bash
CHESS_AI_DATA_PATH=/root/autodl-tmp python train_with_data_disk.py
```

## ğŸ“Š ç£ç›˜ç©ºé—´ç®¡ç†å·¥å…·

### åˆ†æç©ºé—´ä½¿ç”¨æƒ…å†µ
```bash
python disk_space_manager.py analyze
```
è¾“å‡ºç¤ºä¾‹ï¼š
```
=== Chess AI ç£ç›˜ç©ºé—´åˆ†æ ===

æ•°æ®ç›®å½•: /root/autodl-tmp/chess-ai-data
  å¤§å°: 2.3GB
  æœ€å¤§çš„æ–‡ä»¶:
    final_training_data.npz: 1.8GB
    game_data_1234567890_0.pkl: 256.7MB
    training_batch_50.npz: 128.3MB

æ¨¡å‹ç›®å½•: /root/autodl-tmp/chess-ai-models
  å¤§å°: 456.7MB
  æœ€å¤§çš„æ–‡ä»¶:
    final_model.pth: 123.4MB
    checkpoint_iter_50.pth: 123.4MB
    best_model.pth: 123.4MB

é¡¹ç›®æ€»å¤§å°: 2.8GB

ç£ç›˜ç©ºé—´ (/root/autodl-tmp):
  æ€»è®¡: 50.0GB
  å·²ç”¨: 15.2GB (30.4%)
  å¯ç”¨: 34.8GB (69.6%)
  âœ… ç©ºé—´å……è¶³
```

### é¢„è§ˆæ¸…ç†æ“ä½œ
```bash
python disk_space_manager.py preview
```

### æ‰§è¡Œæ¸…ç†
```bash
python disk_space_manager.py cleanup
```

## ğŸ”§ è‡ªåŠ¨åŒ–åŠŸèƒ½

### è®­ç»ƒè¿‡ç¨‹ä¸­çš„è‡ªåŠ¨ç®¡ç†

ä½¿ç”¨ `train_with_data_disk.py` è„šæœ¬æ—¶ï¼Œä¼šè‡ªåŠ¨ï¼š

1. **ç£ç›˜ç©ºé—´æ£€æŸ¥**: æ¯æ¬¡è¿­ä»£å‰æ£€æŸ¥å¯ç”¨ç©ºé—´
2. **è‡ªåŠ¨æ¸…ç†**: ç©ºé—´ä¸è¶³æ—¶è‡ªåŠ¨åˆ é™¤æ—§æ–‡ä»¶
3. **åå°ç›‘æ§**: æ¯5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡ç£ç›˜ç©ºé—´
4. **æ™ºèƒ½ä¿å­˜**: æ ¹æ®å¯ç”¨ç©ºé—´å†³å®šæ˜¯å¦ä¿å­˜å¤§æ–‡ä»¶

### æ¸…ç†ç­–ç•¥

- **æ¨¡å‹æ–‡ä»¶**: ä¿ç•™æœ€æ–°5ä¸ª `.pth` æ–‡ä»¶
- **æ•°æ®æ–‡ä»¶**: ä¿ç•™æœ€æ–°3ä¸ª `.npz` æ–‡ä»¶  
- **æ—¥å¿—æ–‡ä»¶**: ä¿ç•™æœ€è¿‘7å¤©çš„æ—¥å¿—
- **ä¸´æ—¶æ–‡ä»¶**: åˆ é™¤ `.tmp`, `.temp`, `*~` ç­‰ä¸´æ—¶æ–‡ä»¶

## ğŸ“ ç›®å½•ç»“æ„

ä½¿ç”¨æ•°æ®ç›˜åï¼Œæ–‡ä»¶å°†ä¿å­˜åœ¨ï¼š

```
/root/autodl-tmp/  (æˆ–æ‚¨æŒ‡å®šçš„æ•°æ®ç›˜è·¯å¾„)
â”œâ”€â”€ chess-ai-data/          # è®­ç»ƒæ•°æ®
â”‚   â”œâ”€â”€ final_training_data.npz
â”‚   â””â”€â”€ game_data_*.pkl
â”œâ”€â”€ chess-ai-models/        # æ¨¡å‹æ–‡ä»¶
â”‚   â”œâ”€â”€ final_model.pth
â”‚   â”œâ”€â”€ best_model.pth
â”‚   â””â”€â”€ checkpoint_iter_*.pth
â”œâ”€â”€ chess-ai-logs/          # æ—¥å¿—æ–‡ä»¶
â”‚   â””â”€â”€ training/
â””â”€â”€ chess-ai-games/         # PGNæ£‹è°±æ–‡ä»¶
```

## âš™ï¸ é…ç½®é€‰é¡¹

åœ¨ `config/config.py` ä¸­ï¼Œæ‚¨å¯ä»¥è°ƒæ•´ï¼š

```python
# ç£ç›˜ç©ºé—´ç®¡ç†é…ç½®
self.min_free_space_gb = 1.0      # æœ€å°ä¿ç•™ç©ºé—´(GB)
self.max_model_files = 5          # æœ€å¤šä¿ç•™çš„æ¨¡å‹æ–‡ä»¶æ•°
self.max_data_files = 3           # æœ€å¤šä¿ç•™çš„æ•°æ®æ–‡ä»¶æ•°
```

## ğŸš€ æœ€ä½³å®è·µ

1. **å®šæœŸç›‘æ§**: ä½¿ç”¨ `disk_space_manager.py analyze` å®šæœŸæ£€æŸ¥ç©ºé—´ä½¿ç”¨
2. **åŠæ—¶æ¸…ç†**: è®­ç»ƒå®Œæˆåè¿è¡Œ `disk_space_manager.py cleanup`
3. **åˆç†é…ç½®**: æ ¹æ®æ‚¨çš„ç£ç›˜å¤§å°è°ƒæ•´ä¿ç•™æ–‡ä»¶æ•°é‡
4. **å¤‡ä»½é‡è¦æ¨¡å‹**: å°†æœ€ä½³æ¨¡å‹å¤åˆ¶åˆ°å®‰å…¨ä½ç½®

## ğŸ” æ•…éšœæ’é™¤

### é—®é¢˜1: æ‰¾ä¸åˆ°æ•°æ®ç›˜
```bash
# æ‰‹åŠ¨æ£€æŸ¥å¯ç”¨æŒ‚è½½ç‚¹
df -h
mount | grep -E "(autodl|tmp|data)"

# æ‰‹åŠ¨æŒ‡å®šè·¯å¾„
export CHESS_AI_DATA_PATH=/your/data/path
```

### é—®é¢˜2: æƒé™ä¸è¶³
```bash
# æ£€æŸ¥ç›®å½•æƒé™
ls -la /root/autodl-tmp

# åˆ›å»ºç›®å½•
mkdir -p /root/autodl-tmp/chess-ai-data
```

### é—®é¢˜3: ä»ç„¶ç©ºé—´ä¸è¶³
```bash
# å¼ºåˆ¶æ¸…ç†
python disk_space_manager.py cleanup

# å‡å°‘ä¿ç•™æ–‡ä»¶æ•°é‡
# ç¼–è¾‘ config/config.pyï¼Œå‡å°‘ max_model_files å’Œ max_data_files
```

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœä»ç„¶é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š

1. è¿è¡Œ `python disk_space_manager.py analyze` è·å–è¯¦ç»†ä¿¡æ¯
2. æ£€æŸ¥æ—¥å¿—æ–‡ä»¶ä¸­çš„é”™è¯¯ä¿¡æ¯
3. ç¡®è®¤æ•°æ®ç›˜è·¯å¾„å’Œæƒé™è®¾ç½®æ­£ç¡®

---

é€šè¿‡ä»¥ä¸Šæ–¹æ³•ï¼Œæ‚¨åº”è¯¥èƒ½å¤ŸæˆåŠŸè§£å†³ç£ç›˜ç©ºé—´ä¸è¶³çš„é—®é¢˜ï¼Œå¹¶é¡ºåˆ©è¿›è¡ŒChess AIçš„è®­ç»ƒã€‚
